name: Release

on:
  pull_request:
    types: closed
    branches: main

permissions:
  contents: write

jobs:
  github-release:
    runs-on: ubuntu-latest

    # Only merged pull request
    # if: github.event.pull_request.merged

    steps:
      - name: Generate SemVer tag
        id: gen_tag
        uses: K-Phoen/semver-release-action@master
        with:
          release_branch: main
          # release_strategy: none
          # create tag?
          release_strategy: tag
          tag_format: "v%major%.%minor%.%patch%"
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      # remove
      # - name: Print SemVer tag
      #   run: echo "${{ steps.gen_tag.outputs.tag }}"

      # - name: Checkout repository
      #   uses: actions/checkout@v4

      # - name: Publish GitHub release
      #   uses: softprops/action-gh-release@v2
      #   with:
      #     tag_name: ${{ steps.gen_tag.outputs.tag }}
      #     generate_release_notes: true
      #     # files: ./artifacts/**/${{ github.event.repository.name }}-*.zip
      #     # fail_on_unmatched_files: true
      #     make_latest: true
      #     prerelease: false
      #     draft: false

      # - uses: ncipollo/release-action@v1
      #   with:
      #     tag: ${{ steps.gen_tag.outputs.tag }}
      #     # Force update
      #     allowUpdates: true
      #     # Panic on artifact errors
      #     artifactErrorsFailBuild: true
      #     # Generate GitHub automatic release notes
      #     generateReleaseNotes: true
      #     makeLatest: true
      #     # Supply artifacts
      #     # artifacts: "release.tar.gz,foo/*.txt"
      #     # artifactContentType:
      #     # replacesArtifacts: true
